<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bootstrap Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
<body>  
	<div class="container">
		<div class="row">
			<div class="col-md-12"><h1>Edit Image</h1></div>			
			<div class="col-md-6">
				<form onsubmit="callApi()">
					<input type="hidden" name="template_name" value="birthdayTemplate">					

					<fieldset class="scheduler-border">
						<legend class="scheduler-border">Color Effects</legend>
						<div class="form-group">
							<label>Greyscale <span class="rangeValue"></span></label>
							<div class="radio">
								<label class="radio-inline"><input type="radio" value="0" name="greyscale" checked>Off</label>
								<label class="radio-inline"><input type="radio" value="1" name="greyscale">ON</label>
							</div>
						</div>
						<div class="form-group">
							<label>Dither565 <span class="rangeValue"></span></label>
							<div class="radio">
								<label class="radio-inline"><input type="radio" value="0" name="dither565" checked>Off</label>
								<label class="radio-inline"><input type="radio" value="1" name="dither565">ON</label>
							</div>
						</div>
						<div class="form-group">
							<label>Invert <span class="rangeValue"></span></label>
							<div class="radio">
								<label class="radio-inline"><input type="radio" value="0" name="invert" checked>Off</label>
								<label class="radio-inline"><input type="radio" value="1" name="invert">ON</label>
							</div>
						</div>
					</fieldset>

					<fieldset class="scheduler-border">
						<legend class="scheduler-border">Photo Effects</legend>
						<div class="form-group">
							<label>Posterize <span class="rangeValue"></span></label>
							<input onchange="appendValue(this)" type="range" min="0" max="100" value="50" class="slider" name="posterize">
						</div>
						<div class="form-group">
							<label>Sepia <span class="rangeValue"></span></label>
							<div class="radio">
								<label class="radio-inline"><input type="radio" value="0" name="sepia" checked>Off</label>
								<label class="radio-inline"><input type="radio" value="1" name="sepia">ON</label>
							</div>
						</div>
					</fieldset>
					
					<fieldset class="scheduler-border">
						<legend class="scheduler-border">Blur Effects</legend>
						<div class="form-group">
							<label>Gaussian <span class="rangeValue"></span></label>
							<input type="range" min="0" max="100" value="50" class="slider" name="gaussian">
						</div>
						<div class="form-group">
							<label>Blur <span class="rangeValue"></span></label>
							<input type="range" min="0" max="100" value="50" class="slider" name="blur">
						</div>
					</fieldset>

					<fieldset class="scheduler-border">
						<legend class="scheduler-border">Alpha Effects</legend>
						<div class="form-group">
							<label>Fade <span class="rangeValue"></span></label>
							<input type="range" min="0" max="100" value="50" class="slider" name="fade">
						</div>
						<div class="form-group">
							<label>Opacity <span class="rangeValue"></span></label>
							<input type="range" min="0" max="100" value="50" class="slider" name="opacity">
						</div>
						<div class="form-group">
							<label>Opaque <span class="rangeValue"></span></label>
							<div class="radio">
								<label class="radio-inline"><input type="radio" value="0" name="opaque" checked>Off</label>
								<label class="radio-inline"><input type="radio" value="1" name="opaque">ON</label>
							</div>
						</div>
					</fieldset>	

					<button type="submit" class="btn btn-default">Submit</button>
				</form>
			</div>
			<div class="col-md-6">
				<fieldset class="scheduler-border">
					<legend class="scheduler-border">Upload Photo</legend>
					<div class="form-group">
						<input onchange="encodeImgtoBase64(this)" type="file" class="form-control">
					</div>
					<img src="" alt="" id="displayImg">
				</fieldset>
				<fieldset class="scheduler-border">
					<legend class="scheduler-border">Choosen Template</legend>
					<img class="img-responsive" src="./templates/happybirthday.png">
				</fieldset>
			</div>
			<div class="col-md-12"><h1>Footer</h1></div>			
		</div>
	</div>
</body>
<script type="text/javascript">

	function encodeImgtoBase64(element) {
		var img = element.files[0];
		var reader = new FileReader();
		reader.onloadend = function() { 
			$("#displayImg").attr("src", reader.result);
			callApi(reader.result)
		}
		reader.readAsDataURL(img);
    }

	function appendValue(e) {
		var value = jQuery(e).value
		jQuery(e).closest(".form-group").find(".rangeValue").text(value)
	}

	function callApi( inputImage ) {
		var template_name = $("input[name='template_name']").val()
		$.ajax({
			url: "http://localhost:3000",
			method: "POST",
			data: { inputImage, template_name },
			dataType: "html"
		})
		.done(function( msg ) {
			console.log(msg, "post message")
		})
		.fail(function( jqXHR, textStatus ) {
			alert( "Request failed: " + textStatus );
		});
	}

	jQuery(document).ready(function() {

	})
</script>
</html>
